var Q=Object.defineProperty,$=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var P=(r,a,n)=>a in r?Q(r,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[a]=n,j=(r,a)=>{for(var n in a||(a={}))B.call(a,n)&&P(r,n,a[n]);if(N)for(var n of N(a))D.call(a,n)&&P(r,n,a[n]);return r},L=(r,a)=>$(r,U(a));import{j as A,r as g,R as M,a as T}from"./vendor.08ce63be.js";const w=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))h(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&h(u)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function h(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}};w();var E=120;function z(r,a){return r.match(new RegExp(".{1,"+a+"}","g"))}const F=()=>fetch("/pages.txt").then(r=>r.text()),H=({pageArray:r,word:a})=>{console.log("starting book search"),console.log("book length",r.length);let n=[-1,-1,-1,0,0,1,1,1],h=[-1,0,1,-1,1,-1,0,1];function e(d,i,c,f,k,t){if(d[i][c]!=f[0])return!1;let l=f.length;for(let p=0;p<8;p++){var v=[];let m,y=i+n[p],x=c+h[p];for(m=1;m<l&&!(y>=k||y<0||x>=t||x<0||d[y][x]!=f[m]);m++)v.push({x:y,y:x}),y+=n[p],x+=h[p];if(m==l)return[{x:i,y:c},...v]}return!1}function o(d,i){var c=d.length,f=E;for(let t=0;t<c;t++)for(let l=0;l<f;l++){var k=e(d,t,l,i.toUpperCase(),c,f);if(k)return k}}var u=[];return r.forEach((d,i)=>{var c=o(d,a);c&&u.push(c.map(f=>L(j({},f),{page:i})))}),console.log("finished book search"),u},I=r=>{var a=r.split(`
`),n=[],h=[];a.forEach(o=>{o.includes("Page |")?(n.push(h),h=[]):h.push(o.toLowerCase().replace(/[^a-z]/gi,"").toUpperCase())});var e=[];return n.forEach((o,u)=>{var d=z(o.join(""),E).map(i=>i.split(""));d=d.map(i=>{var c=E-i.length;return c==0?i:[...i,...Array.from({length:c}).map(()=>" ")]}),e.push(d)}),e},s=A.exports.jsx,b=A.exports.jsxs;var q={};function K(){g.exports.useState(q);const[r,a]=g.exports.useState(),[n,h]=g.exports.useState(""),[e,o]=g.exports.useState(0),[u,d]=g.exports.useState([]),[i,c]=g.exports.useState([]);if(g.exports.useEffect(()=>{if(!(!r||!n)){var t=n.split(" ").filter(l=>l.length>=2);d(t)}},[n]),g.exports.useEffect(()=>{!r||!n||c(u.map(t=>H({pageArray:r,word:t})))},[u]),g.exports.useEffect(()=>{},[o]),g.exports.useEffect(async()=>{var t=await F();a(I(t))},[]),console.log({book:r}),!r)return s("div",{children:"Loading!"});const f=({page:t,data2d:l=[],highlights:v})=>s("table",{children:s("tbody",{children:l.map((p,m)=>s("tr",{children:p.map((y,x)=>{var C="";return v.forEach((R,W)=>R.forEach(O=>O.forEach((S,G)=>{S.x==m&&S.y==x&&S.page==t&&(C="red")}))),s("td",{className:`${C} page${t} x${m} y${x}`,children:y})})}))})}),k=({data2d:t=[]})=>s("table",{children:s("tbody",{children:t.map((l,v)=>s("tr",{children:l.map((p,m)=>s("td",{onClick:()=>o(p),className:"",children:p}))}))})});return console.log({ok:i.flat().flat().map(t=>t.page)}),b("div",{className:"App",children:[s("div",{}),s("div",{children:'Current book: "Harry Potter"'}),b("div",{children:[s("label",{htmlFor:"searchQuery",children:"Search Query"}),s("input",{name:"searchQuery",type:"text",onChange:t=>h(t.target.value.toUpperCase()),value:n,placeholder:"Will search for each word"})]}),b("div",{children:[b("div",{children:["currentPage:",e+1,"/",r.length]}),s("div",{className:"button",onClick:t=>o(e>=0?e+1:e),children:"Next page"}),s("div",{className:"button",onClick:t=>o(e>0?e-1:e),children:"Previous page"})]}),b("div",{children:[s("div",{children:s(k,{data2d:[r.map((t,l)=>l).filter(t=>i.flat().flat().map(l=>l.page).includes(t))]})}),s("div",{children:u.map((t,l)=>{var v;return b("div",{children:[t,": ",((v=i[l])==null?void 0:v.length)||0]})})})]}),b("div",{children:[s("div",{children:"Table"}),s("div",{children:s(f,{page:e,data2d:r[e],highlights:i})})]})]})}M.render(s(T.StrictMode,{children:s(K,{})}),document.getElementById("root"));
